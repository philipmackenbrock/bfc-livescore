<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!doctype html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="de"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;title&gt;Live Ranking&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>:root{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--bg:#f7fafc;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--card:#fff;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--muted:#6b7280;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--accent:#0f172a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--accent-2:#374151;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--good: rgba(34,197,94,0.12);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>--bad:<span class="Apple-converted-space">  </span>rgba(239,68,68,0.10);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>html,body{height:100%}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background:var(--bg);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color:var(--accent);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin:0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding:28px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>-webkit-font-smoothing:antialiased;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>-moz-osx-font-smoothing:grayscale;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.container { max-width:1100px; margin:0 auto; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.leaderboard {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>background:var(--card);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-radius:12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding:18px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>box-shadow:0 6px 20px rgba(2,6,23,0.06);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>overflow:hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>header.top {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>display:flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>align-items:baseline;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>gap:16px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>margin-bottom:12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>h1 { margin:0; font-size:1.25rem; font-weight:600; color:var(--accent-2) }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.meta { color:var(--muted); font-size:0.9rem }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>#error { color:#b91c1c; margin-top:8px; font-size:0.95rem; display:none }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>table {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>width:100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-collapse:collapse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>table-layout:fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-size:0.95rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>thead th {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>text-align:left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding:12px 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>font-weight:700;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>color:var(--muted);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-bottom:1px solid #eef2f6;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody td {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>padding:10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>border-bottom:1px solid #f3f6f9;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>vertical-align:middle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>overflow:hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>text-overflow:ellipsis;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>white-space:nowrap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.pos { width:56px; text-align:center; font-weight:700; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.competitor { min-width:160px; font-weight:600; color:var(--accent-2) }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.value { text-align:center; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.score { text-align:right; font-weight:700; width:110px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr { background:transparent; will-change: transform, opacity; transition: box-shadow .35s ease; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr.rank-up { box-shadow: inset 6px 0 0 var(--good); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr.rank-down { box-shadow: inset 6px 0 0 var(--bad); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr.top1 { background: linear-gradient(90deg, rgba(255,215,0,0.06), transparent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr.top2 { background: linear-gradient(90deg, rgba(192,192,192,0.05), transparent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tbody tr.top3 { background: linear-gradient(90deg, rgba(205,127,50,0.05), transparent); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>@media (max-width:820px){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>.competitor { min-width:120px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>.score { width:80px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>thead th, tbody td { padding:8px; font-size:0.88rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>.pos { width:44px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>/* helper small text */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.note { margin-top:8px; font-size:0.88rem; color:var(--muted) }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="leaderboard" aria-live="polite"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;header class="top"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h1&gt;Live Ranking&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="meta" id="lastUpdated"&gt;—&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div id="error" role="alert"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;table id="board" role="table" aria-label="Live ranking table"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;thead&gt;&lt;tr id="headerRow"&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;tbody&gt;&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/table&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="note"&gt;Datenquelle: Google Sheets (Live). Aktualisiert automatisch.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">/* ====== CONFIG (keep as provided) ====== */</span></p>
<p class="p1"><span class="s1">const SHEET_ID = "1H7pI6CWOnP6QedIxfdFLRO_8DkswdLTc7v5rSu0TvNA";</span></p>
<p class="p1"><span class="s1">const API_KEY<span class="Apple-converted-space">  </span>= "AIzaSyBGFkhdQZ3le5u_dI-fsmDMoD1VMPkQXEE";</span></p>
<p class="p1"><span class="s1">const RANGE<span class="Apple-converted-space">    </span>= "Live!B1:K100"; // B=Name, C-J values, K Total</span></p>
<p class="p1"><span class="s1">const POLL_MS<span class="Apple-converted-space">  </span>= 8000; <span class="Apple-converted-space">          </span>// refresh every 8s</span></p>
<p class="p1"><span class="s1">/* ====================================== */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const URL = `https://sheets.googleapis.com/v4/spreadsheets/${encodeURIComponent(SHEET_ID)}/values/${encodeURIComponent(RANGE)}?key=${encodeURIComponent(API_KEY)}`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const tbody = document.querySelector('#board tbody');</span></p>
<p class="p1"><span class="s1">const headerRow = document.getElementById('headerRow');</span></p>
<p class="p1"><span class="s1">const lastUpdatedEl = document.getElementById('lastUpdated');</span></p>
<p class="p1"><span class="s1">const errorEl = document.getElementById('error');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">let rowElements = new Map(); // id -&gt; tr</span></p>
<p class="p1"><span class="s1">let previousOrder = [];</span></p>
<p class="p1"><span class="s1">let previousRanks = {};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// sanitize text</span></p>
<p class="p1"><span class="s1">function text(node, str){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(node) node.textContent = (str === undefined || str === null) ? '' : String(str);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// create a TR element for a row (data array: [Name, val1..val8, Total] indexes 0..9)</span></p>
<p class="p1"><span class="s1">function createRow(id, dataArray){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tr.dataset.id = id;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// position cell</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const tdPos = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdPos.className = 'pos';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdPos.setAttribute('aria-label','Position');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdPos.textContent = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tr.appendChild(tdPos);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// name</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const tdName = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdName.className = 'competitor';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdName.setAttribute('aria-label','Competitor');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>text(tdName, dataArray[0] || '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tr.appendChild(tdName);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// values C-J -&gt; indices 1..8</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>for(let i=1;i&lt;=8;i++){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const td = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>td.className = 'value';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>td.setAttribute('aria-label',`Value ${i}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>text(td, dataArray[i] || '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tr.appendChild(td);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// total (index 9)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const tdTotal = document.createElement('td');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdTotal.className = 'score';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tdTotal.setAttribute('aria-label','Total');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>text(tdTotal, dataArray[9] || '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>tr.appendChild(tdTotal);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return tr;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// update existing tr with new data</span></p>
<p class="p1"><span class="s1">function updateRow(tr, dataArray){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(!tr) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const cells = tr.children;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// cells[0] = pos, [1] = name, [2..9] values, last = total</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>text(cells[1], dataArray[0] || '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>for(let i=1;i&lt;=8;i++){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const idx = 1 + i; // cell index</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(cells[idx]) text(cells[idx], dataArray[i] || '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// total is last cell</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const totalCell = cells[cells.length - 1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(totalCell) text(totalCell, dataArray[9] || '');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// FLIP-based render with smooth slide animation</span></p>
<p class="p1"><span class="s1">function renderFlip(header, rows){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(!header || header.length === 0) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// Build header row (B1..K1) -&gt; header[0] is "Name", header[1..8] categories, header[9] "Total"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>headerRow.innerHTML = ''; // rebuild safely</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const thPos = document.createElement('th'); thPos.className='pos'; thPos.textContent='#'; headerRow.appendChild(thPos);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const thName = document.createElement('th'); thName.className='competitor'; thName.textContent = header[0] || 'Name'; headerRow.appendChild(thName);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>for(let i=1;i&lt;=8;i++){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const th = document.createElement('th');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>th.className = 'value';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>th.textContent = header[i] || '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>headerRow.appendChild(th);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const thTotal = document.createElement('th'); thTotal.className='score'; thTotal.textContent = header[9] || 'Total'; headerRow.appendChild(thTotal);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// sort rows descending by total (index 9)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>rows.sort((a,b)=&gt; Number((b[9]||0)) - Number((a[9]||0)));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// newOrder (IDs)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const newOrder = rows.map((r, i) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// id from name (must be stable); fallback to index-based unique id</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const name = (r[0]||'').toString().trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return name.length ? name : `__row_${i}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const rowsById = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>rows.forEach((r,i)=&gt; rowsById[newOrder[i]] = r);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// removals: elements in previousOrder not in newOrder</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const removed = previousOrder.filter(id =&gt; !newOrder.includes(id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>removed.forEach(id =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const tr = rowElements.get(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(!tr) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tr.style.transition = 'transform 300ms ease, opacity 300ms ease, height 300ms ease';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tr.style.transform = 'translateY(-8px)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>tr.style.opacity = '0';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setTimeout(()=&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if(tr.parentElement) tr.parentElement.removeChild(tr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rowElements.delete(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, 320);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// measure start positions</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const firstRects = new Map();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>rowElements.forEach((el,id) =&gt; firstRects.set(id, el.getBoundingClientRect()));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// append/create nodes in new order</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>newOrder.forEach((id, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const data = rowsById[id] || [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(rowElements.has(id)){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const el = rowElements.get(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>updateRow(el, data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tbody.appendChild(el); // moves el to new position</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const el = createRow(id, data);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// start invisible for entry animation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>el.style.opacity = '0';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>el.style.transform = 'translateY(-8px)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>tbody.appendChild(el);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rowElements.set(id, el);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// measure last positions</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const lastRects = new Map();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>rowElements.forEach((el,id) =&gt; lastRects.set(id, el.getBoundingClientRect()));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// FLIP animate</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>rowElements.forEach((el, id) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const first = firstRects.get(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const last = lastRects.get(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>el.style.transition = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(first){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const deltaY = first.top - last.top;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if(Math.abs(deltaY) &gt; 0.5){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.transform = `translateY(${deltaY}px)`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.opacity = '1';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>requestAnimationFrame(()=&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>el.style.transition = 'transform 600ms cubic-bezier(.2,.8,.2,1)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>el.style.transform = 'translateY(0)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.transform = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.opacity = '1';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>// new element</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>requestAnimationFrame(()=&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.transition = 'transform 600ms cubic-bezier(.2,.8,.2,1), opacity 600ms';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.transform = 'translateY(0)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.style.opacity = '1';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// set pos cell after animation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const posCell = el.querySelector('.pos');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const newPos = newOrder.indexOf(id) + 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(posCell) posCell.textContent = newPos;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// clear any previous classes then set top classes etc</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>el.classList.remove('rank-up','rank-down','top1','top2','top3');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>// compute rank changes and set highlight classes temporarily</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const newRanks = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>newOrder.forEach((id, idx) =&gt; newRanks[id] = idx+1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>newOrder.forEach((id, idx) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const pos = idx+1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const el = rowElements.get(id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(!el) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(pos === 1) el.classList.add('top1');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(pos === 2) el.classList.add('top2');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(pos === 3) el.classList.add('top3');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const old = previousRanks[id];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(old !== undefined &amp;&amp; old !== pos){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if(old &gt; pos) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.classList.add('rank-up');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setTimeout(()=&gt; el.classList.remove('rank-up'), 1200);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>el.classList.add('rank-down');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>setTimeout(()=&gt; el.classList.remove('rank-down'), 1200);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>previousOrder = newOrder.slice();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>previousRanks = Object.assign({}, newRanks);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// fetch from Sheets</span></p>
<p class="p1"><span class="s1">async function fetchValues(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const res = await fetch(URL, {cache:'no-store'});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(!res.ok){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// better error message for user</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const text = await res.text().catch(()=&gt; '');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>throw new Error(`${res.status} ${res.statusText} ${text}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const json = await res.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return json.values || [];</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// update last updated timestamp (Europe/Berlin)</span></p>
<p class="p1"><span class="s1">function setLastUpdated(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const now = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const s = now.toLocaleString('de-DE', { timeZone: 'Europe/Berlin', hour12:false });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lastUpdatedEl.textContent = `Letzte Aktualisierung: ${s}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} catch(e){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>lastUpdatedEl.textContent = `Letzte Aktualisierung: ${new Date().toISOString()}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// main refresh</span></p>
<p class="p1"><span class="s1">let isRefreshing = false;</span></p>
<p class="p1"><span class="s1">async function refresh(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(isRefreshing) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>isRefreshing = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>errorEl.style.display = 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>try{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const values = await fetchValues(); // returns array of rows (B1..K)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(!values || values.length &lt;= 1){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>throw new Error('Keine Daten in Live sheet gefunden.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const header = values[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const rows = values.slice(1); // each row: [Name, v1..v8, total]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>renderFlip(header, rows);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setLastUpdated();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} catch(err){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>console.error('Fetch error', err);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>errorEl.style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>errorEl.textContent = 'Fehler beim Laden der Live-Daten. Bitte Seite neu laden oder später versuchen.';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>isRefreshing = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// initial load + polling</span></p>
<p class="p1"><span class="s1">refresh();</span></p>
<p class="p1"><span class="s1">setInterval(refresh, POLL_MS);</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
